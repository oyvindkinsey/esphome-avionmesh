<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Avionmesh</title>
<link rel="stylesheet" href="/ui.css">
</head>
<body>

<header class="app-header">
  <span class="app-title">Avionmesh</span>
  <div class="status-bar">
    <span><span class="s">BLE:</span> <span id="bleState" class="v ble-bad">--</span></span>
    <span><span class="s">Devices:</span> <span id="devCount" class="v">0</span></span>
    <span><span class="s">Groups:</span> <span id="grpCount" class="v">0</span></span>
    <span><span class="s">RX:</span> <span id="rxCount" class="v">0</span></span>
    <span id="sseDot" class="sse-dot sse-off"></span>
  </div>
  <button class="sm ghost" onclick="saveDb()" id="btnSave">Save</button>
  <span id="saveMsg" class="save-msg"></span>
</header>

<section>
  <div class="section-header">
    <h2 class="section-title">Devices</h2>
  </div>
  <div id="deviceGrid" class="card-grid">
    <p class="empty">Connecting&hellip;</p>
  </div>
</section>

<section>
  <div class="section-header">
    <h2 class="section-title">Groups</h2>
    <input id="newGrpName" type="text" placeholder="Group name" style="width:130px">
    <button class="sm" onclick="createGroup()">+ Create</button>
  </div>
  <div id="groupGrid" class="card-grid">
    <p class="empty">Connecting&hellip;</p>
  </div>
</section>

<details class="section">
  <summary>Scan &amp; Add Devices</summary>
  <div class="section-body">
    <div class="row">
      <button onclick="startMeshScan()" id="btnMeshScan">Mesh Ping Scan</button>
      <button onclick="startUnassocScan()" id="btnUnassocScan">Scan for New</button>
    </div>
    <div id="scanMsg"></div>
    <table id="scanResults" class="hidden" style="margin-top:8px">
      <thead><tr><th>ID</th><th>FW</th><th>Vendor</th><th>Product</th><th>Status</th><th></th></tr></thead>
      <tbody id="scanBody"></tbody>
    </table>
    <div id="unassocResults" class="hidden" style="margin-top:8px">
      <div style="font-size:.82em;color:var(--dim);margin-bottom:6px">Unassociated Devices</div>
      <div id="unassocList"></div>
    </div>
  </div>
</details>

<details class="section">
  <summary>Setup</summary>
  <div class="section-body">
    <div class="row">
      <input id="newPassphrase" type="password" placeholder="Base64 passphrase (&ge;16 decoded)" style="width:260px">
      <button onclick="setPassphrase()">Set</button>
      <button onclick="generatePassphrase()">Generate</button>
    </div>
    <div id="setupMsg"></div>
    <div class="row" style="margin-top:10px">
      <button class="danger" onclick="factoryReset()">Factory Reset</button>
    </div>
  </div>
</details>

<details class="section">
  <summary>Event Feed</summary>
  <div class="section-body">
    <div id="eventFeed"></div>
  </div>
</details>

<script src="/ui.js"></script>
</body>
</html>
